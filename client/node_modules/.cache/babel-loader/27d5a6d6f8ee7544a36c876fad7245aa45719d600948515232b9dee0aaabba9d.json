{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tonigaligimeno/Documents/BCS/Full-Stack Web App/Filmix/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/tonigaligimeno/Documents/BCS/Full-Stack Web App/Filmix/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/tonigaligimeno/Documents/BCS/Full-Stack Web App/Filmix/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate}from\"react-router-dom\";import Home from\"./views/Home\";import Login from\"./views/Login\";import Register from\"./views/Register\";import Secret from\"./views/Secret\";import{URL}from\"./config\";import axios from\"axios\";import Series from\"./views/Series\";import Movies from\"./views/Movies\";import MyList from\"./views/MyList\";import Settings from\"./views/Settings\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoggedIn=_useState2[0],setIsLoggedIn=_useState2[1];var token=JSON.parse(localStorage.getItem(\"token\"));useEffect(function(){var verify_token=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(token==null)){_context.next=2;break;}return _context.abrupt(\"return\",setIsLoggedIn(false));case 2:_context.prev=2;axios.defaults.headers.common[\"Authorization\"]=token;_context.next=6;return axios.post(\"\".concat(URL,\"/users/verify_token\"));case 6:res=_context.sent;return _context.abrupt(\"return\",res.data.ok?login(token):logout());case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);console.info(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[2,10]]);}));return function verify_token(){return _ref.apply(this,arguments);};}();verify_token();// eslint-disable-next-line\n},[]);var login=function login(token){token&&localStorage.setItem(\"token\",JSON.stringify(token));setIsLoggedIn(true);};var logout=function logout(){localStorage.removeItem(\"token\");setIsLoggedIn(false);};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:isLoggedIn?/*#__PURE__*/_jsx(Navigate,{to:\"/browse\"}):/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/login\",element:isLoggedIn?/*#__PURE__*/_jsx(Navigate,{to:\"/browse\"}):/*#__PURE__*/_jsx(Login,{login:login})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/register\",element:isLoggedIn?/*#__PURE__*/_jsx(Navigate,{to:\"/browse\"}):/*#__PURE__*/_jsx(Register,{login:login})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/browse\",element:isLoggedIn?/*#__PURE__*/_jsx(Secret,{logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/series\",element:isLoggedIn?/*#__PURE__*/_jsx(Series,{logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/movies\",element:isLoggedIn?/*#__PURE__*/_jsx(Movies,{logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/mylist\",element:isLoggedIn?/*#__PURE__*/_jsx(MyList,{logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/settings\",element:isLoggedIn?/*#__PURE__*/_jsx(Settings,{logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})})]})})});}","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","Home","Login","Register","Secret","URL","axios","Series","Movies","MyList","Settings","App","isLoggedIn","setIsLoggedIn","token","JSON","parse","localStorage","getItem","verify_token","defaults","headers","common","post","res","data","ok","login","logout","console","info","setItem","stringify","removeItem"],"sources":["/Users/tonigaligimeno/Documents/BCS/Full-Stack Web App/Filmix/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n  Navigate,\n} from \"react-router-dom\";\nimport Home from \"./views/Home\";\nimport Login from \"./views/Login\";\nimport Register from \"./views/Register\";\nimport Secret from \"./views/Secret\";\nimport { URL } from \"./config\";\nimport axios from \"axios\";\nimport Series from \"./views/Series\";\nimport Movies from \"./views/Movies\";\nimport MyList from \"./views/MyList\";\nimport Settings from \"./views/Settings\";\n\nexport default function App() {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n\n  const token = JSON.parse(localStorage.getItem(\"token\"));\n\n  useEffect(() => {\n    const verify_token = async () => {\n      if (token == null) return setIsLoggedIn(false);\n      try {\n        axios.defaults.headers.common[\"Authorization\"] = token;\n        const res = await axios.post(`${URL}/users/verify_token`);\n        return res.data.ok ? login(token) : logout();\n      } catch (e) {\n        console.info(e);\n      }\n    };\n    verify_token();\n    // eslint-disable-next-line\n  }, []);\n\n  const login = (token) => {\n    token && localStorage.setItem(\"token\", JSON.stringify(token));\n    setIsLoggedIn(true);\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    setIsLoggedIn(false);\n  };\n  return (\n    <div>\n      <Router>\n        <Routes>\n          <Route\n            exact\n            path=\"/\"\n            element={isLoggedIn ? <Navigate to=\"/browse\" /> : <Home />}\n          />\n          <Route\n            exact\n            path=\"/login\"\n            element={\n              isLoggedIn ? <Navigate to=\"/browse\" /> : <Login login={login} />\n            }\n          />\n          <Route\n            exact\n            path=\"/register\"\n            element={\n              isLoggedIn ? (\n                <Navigate to=\"/browse\" />\n              ) : (\n                <Register login={login} />\n              )\n            }\n          />\n          <Route\n            exact\n            path=\"/browse\"\n            element={\n              isLoggedIn ? (\n                <Secret logout={logout}  />\n              ) : (\n                <Navigate to=\"/\" />\n              )\n            }\n          />\n          <Route\n            exact\n            path=\"/series\"\n            element={isLoggedIn ? <Series logout={logout} /> : <Navigate to=\"/login\" />}\n          />\n          <Route\n            exact\n            path=\"/movies\"\n            element={isLoggedIn ? <Movies logout={logout} /> : <Navigate to=\"/login\" />}\n          />\n          <Route\n            exact\n            path=\"/mylist\"\n            element={isLoggedIn ? <MyList logout={logout} /> : <Navigate to=\"/login\" />}\n          />\n          <Route\n            exact\n            path=\"/settings\"\n            element={isLoggedIn ? <Settings logout={logout} /> : <Navigate to=\"/login\" />}\n          />\n        </Routes>\n      </Router>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}